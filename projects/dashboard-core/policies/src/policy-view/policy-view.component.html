<!--
    Copyright (c) 2025 Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V.

    This program and the accompanying materials are made available under the
    terms of the Apache License, Version 2.0 which is available at
    https://www.apache.org/licenses/LICENSE-2.0

    SPDX-License-Identifier: Apache-2.0

    Contributors:
         Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V. - initial API and implementation
-->

<div class="flex-row flex-nowrap flex mb-4">
  <lib-filter-input
    placeholder="Filter for ID ..."
    [focusShortcut]="['Alt', 'j']"
    class="mr-4 grow"
    (inputChange)="filter($event)"
  ></lib-filter-input>
  <button
    class="mr-4 btn btn-lg btn-primary rounded-2xl btn-soft shadow-xl !text-sm border-none"
    (click)="createPolicy()"
  >
    <span class="material-symbols-rounded">add</span>
    Create
  </button>
  <lib-item-count-selector
    class="mr-4"
    [currentItemCount]="pageItemCount"
    (itemCountChanged)="pageItemCount = $event"
  ></lib-item-count-selector>
  <lib-pagination
    [items]="filteredPolicies$ | async"
    [pageItemCount]="15"
    (pageItems)="paginationEvent($event)"
    class="shadow-xl rounded-2xl bg-base-300 [&_button:hover]:bg-base-100 [&_.join>button]:first:rounded-l-2xl [&_.join>button]:last:rounded-r-2xl"
  ></lib-pagination>
</div>

<div class="grid w-full gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5">
  @for (policyDefinition of pagePolicies$ | async; track policyDefinition.id) {
    <lib-policy-card
      class="rounded-2xl shadow-xl [&_>.card]:h-full"
      [policyDefinition]="policyDefinition"
      (detailsEvent)="openDetails($event)"
      (editEvent)="editPolicy($event)"
      (deleteEvent)="deletePolicy($event)"
    ></lib-policy-card>
  }
  @if ((policies$ | async)?.length === 0) {
    <div class="skeleton flex justify-center items-center h-72 shadow-xl rounded-2xl">
      @if (!fetched) {
        <span class="loading loading-bars loading-lg opacity-75 text-primary"></span>
      } @else {
        <div class="tooltip tooltip-open tooltip-primary" data-tip="No policies yet! Create your first policy.">
          <button class="btn btn-primary btn-dash" (click)="createPolicy()">
            <span class="material-symbols-rounded">add</span>
            Create
          </button>
        </div>
      }
    </div>
  }
</div>
